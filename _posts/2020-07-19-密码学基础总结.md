---
title: 密码学基础总结
tags: 安全
---

[toc]

[toc]

# 基础概念

## 信息安全三要素（CIA）

- 机密性
- 完整性
- 可用性

扩展：

六要素：

- 机密性
- 所有权
- 完整性
- 可认证性
- 可用性
- 实用性

八要素：

- 机密性
- 完整性
- 可用性
- 隐私性
- 可认证性于可信任性
- 不可抵赖性
- 可说明性
- 可审计性

# 安全性攻击形式

- 被动攻击
  - 截取

- 主动攻击
  - 中断
  - 篡改
  - 伪造
  - 重放

# 密码编码学

## 保密体制

- 对称加密体制
- 非对称加密体制

## 认证体制

- 消息认证
  - 消息认证码体制
  - 数字签名
- 实体认证
  - 生份鉴别协议

# 对称与非对称加密体制

## 对称加密体制

实用的秘钥必须完全保密，且要求加密秘钥和解密秘钥相同或由其中一个可以很容易推出另外一个

- 优点

1. 速度快，有很高的吞吐率，软硬件易于实现
2. 秘钥相对较短
3. 对称保密体制密文长度往往与明文相同，或扩张较小

- 缺点

1. 秘钥分发需要安全通道
2. 秘钥量大，难管理
3. 难以解决不可否认性

## 非对称加密体制

秘钥有两个，一个对外公开，另外一个必须保密，不能从公钥推到私钥，或者是计算困难

- 优点

1. 秘钥分发容易
2. 秘钥管理简单
3. 可以有效实现数字签名

- 缺点

1. 速度慢
2. 同等安全下，非对称密码体制对秘钥位数要多一些
3. 非对称保密体制中，密文长度往往大于明文长度

# 柯克霍夫原则

> kerckhoffs princip

秘钥必须完全寓于秘钥中，即加密和解密算法的安全性取决于秘钥的安全性，而加密解密的过程和细节是公开的，只要秘钥是安全的，则攻击者无法推出明文

实际应用中，攻击者的能力还会受到进一步限制：

1. 破解密码系统的成本不超过被加密信息本身
2. 破译密码系统时间不超过被加密信息的有效生命周期

# 密码学加密系统的五元组

```
明文，密文，密钥，加密算法，解密算法
```

# 密码体制攻击类型

- 唯密文攻击（Ciphertext only）
   破译者已知：加密算法、待破译的密文  
- 已知明文攻击（Known plaintext）
   破译者已知：加密算法、一定数量的明文和对应的密文 
- 选择明文攻击（Chosen plaintext） 
  破译者已知：加密算法、选定的明文和对应的密文
- 选择密文攻击（Chosen ciphertext） 
  破译者已知：加密算法、选定的密文和对应的明文
- 选择文本攻击（Chosen text）
  破译者已知：加密算法、选定的明文和对应的密文、选定的密文和对应的明文

# 对加密系统的攻击类型（前四种）

```
1.已知明文攻击 （知道一些名密文对）
2选择明文攻击 （任意明文->密文）
3.唯密文攻击 （只知道一些密文）    
4选择密文攻击（任意密文->明文）
5.选择文本攻击（任意明文<->任意密文）
```

# 攻击常用方法

- 穷举
- 统计分析
- 数学分析

# 熵

*随机事件x发生的概率的对数的相反数定义为该随机事件的自信息量，记为I（xi），设xi发生的概率为p（xi），则自信息量为：*
$$
I(x)_{i} = - log_{2}p(x_{i})
$$
底数为2，信息量单位为比特，如果以e为底数，单位为奈特

# 古典密码

## 置换

置换：根据一定的规则重新排列明文，打破明文结构特性

### 列置换

> 明文按照秘钥规则按列换位并且得到密文

![置换密码](/img/置换密码.png)



### ![置换密码举例](/img/置换密码举例.png)

![列置换](/img/列置换.png)

![列置换2](/img/列置换2.png)

### 周期置换

> 将明文按照固定长度分组，然后对每组按照某种排列位置得到密文

**例子**:

-  明文：“State Key Laboratory of Networking and Switching”

- 加密的密钥：S=(1 5 6 2 3)；

- 将明文分为七组，每组6个字符，不足6个的用双方规定好的字符进行填充，比如空格。

​      P’ = (StateK)(eyLabo)(ratory)(ofNetw)(orking)(andSwi)(tching)

- 对每组的字符进行加密，根据密钥S，可知将第1个字符放在第5个字符的位置，第5个字符放在第6个字符的位置，第6个字符放在第2个字符的位置，第2个字符放在第3个字符的位置，第3个字符放在第1个字符的位置，置换后P'如下：

  P‘ = (aKttSe)(Loyaeb)(tyaorr)(Nwfeot)(kgrion)(dinSaw)(hgcitn)

  所以得到的最终密文Pm = "aKttSeLoyaebtyaorrNwfeotkgriondinSawhgcitn"

- 周期置换的解密方法就是加密的逆运算，只需求出密钥的逆置换即可。可以知道密钥S=(1 5 6 2 3)的逆置换S’ = (1 3 2 6 5)，所以只需将密文重新分组，通过S'的置换顺序就可以得出明文P

## 代换密码

代换，就是将明文中的一个字母由其它字母、数字或者符号替代的一种方法
代换密码建立一个代换表，加密时将需要加密的明文依次通过查表，替换为相应的字符，明文字符被逐个替换后，生成无任何意义的字符串，即密文。这样的代换表被称为密钥

### 单表代换密码

单表代换是指英文字母在进行密码编码替换的时候，有一张对照表，也就是说，对于每一个字母，都是唯一对应的，如：

26个源字母表为：abcdefghijklmnopqrstuvwxyz

代换的字母表为：qwertyuiopasdfghjklzxcvbnm

在加密时，按照设计好的对照表对每一个明文字母进行替换，如a替换为q，b替换为w等。

### 放射密码

加法密码和乘法密码结合就构成仿射密码，仿射密码的加密和解密算法是：
$$
C=EK(m)=(k_{1}m+k_{2})modn\\
M = DK(C)=k_{3}(C-k_{2})mod n\\
(k_{3}Xk_{1})mod 26=1\\
$$


---

仿射密码具有可逆性的条件是:

`gcd(k1, n)=1`. 当k1=1时，仿射密码变为加法密码，当k2=0时，仿射密码变为乘法密码。
仿射密码中的密钥空间的大小为`nφ(n)`，当`n`为`26`字母，`φ(n)=12`，因此仿射密码的密钥空间为12×26 = 312

#### 例子

设放射密码加密函数为：`e(x)=11x+6(mod 26)`,则有11^{-1}(mod26)=19,所以解密函数:`x=19[e(x)-6]=19e(x)+16(mod 26)`

设加密明文：`sorcery`，转换为数字：`18,14,17,2,4,17,24`



-----



加密：
$$
11*
 \left[
 \begin{matrix}
   18 \\
   14 \\
   17\\
   2\\
   4\\
   17\\
   24\\
  \end{matrix}
  \right]
+
 \left[
 \begin{matrix}
   6 \\
   6 \\
   6\\
   6\\
   6\\
   6\\
   6\\
  \end{matrix}
  \right]
  =
   \left[
 \begin{matrix}
   204 \\
   160\\
   193\\
  28\\
   50\\
   193\\
  270\\
  \end{matrix}
  \right]
  =
   \left[
 \begin{matrix}
   22 \\
   4\\
   11\\
  2\\
   24\\
   11\\
  10\\
  \end{matrix}
  \right]
 (mod26)
< =>
 \left[
 \begin{matrix}
   W \\
   E\\
   L\\
   C\\
   y\\
   L\\
   K\\
  \end{matrix}
  \right]
$$
-----------------------

解密：
$$
19*
 \left[
 \begin{matrix}
   22 \\
   4 \\
   11\\
   2\\
   24\\
   11\\
   10\\
  \end{matrix}
  \right]
+
 \left[
 \begin{matrix}
   16 \\
   16 \\
   16\\
   16\\
   16\\
   16\\
   16\\
  \end{matrix}
  \right]
  =
   \left[
 \begin{matrix}
   434 \\
   92\\
   225\\
  54\\
   472\\
   225\\
  206\\
  \end{matrix}
  \right]
  =
   \left[
 \begin{matrix}
   18\\
   14\\
   17\\
  2\\
   4\\
   17\\
  24\\
  \end{matrix}
  \right]
 (mod26)
< =>
 \left[
 \begin{matrix}
   s \\
   o\\
   r\\
   c\\
   e\\
   r\\
   y\\
  \end{matrix}
  \right]
$$

------



> 求逆元：**扩展欧几里得算法**

### 多表代换

#### 维吉尼亚密码

![多表代换](/img/多表代换.png)

------

例题：

p=data security , k = best

先将明文分解为长为4的序列：

data 			secu 			rity

每个序列用秘钥best加密

密文：EELT  	TIUN	  SMLR

#### Playfair密码

![维吉尼亚密码](/img/维吉尼亚密码.png)



![playfair2](/img/playfair2.png)

例题：

设秘钥为：PLAYFAIR IS A DIGRAM CIPHER

-----



字母矩阵：
$$
\left[
 \begin{matrix}
  P&L &A &Y& F \\
   I/J&R&S&D&G\\
   M&C&H&E&B\\
   K&N&O&Q&T\\
   U&V&W&X&Z\\
  \end{matrix}
  \right]
$$


---

明文：pI ay fa ir ci ph er

密文: LA YF PY RS MR AM CD

#### 希尔密码

![希尔密码](/img/希尔密码.png)

例题：

明文：cyber，数字化：2,24,1,4,17

-------

秘钥:
$$
\left[
\begin{matrix}
  10&5 &12 &0& 0 \\
   3&14&21&0&0\\
   8&9&11&0&0\\
   0&0&0&11&8\\
   0&0&0&3&7\\
  \end{matrix}
  \right]
$$
-------

加密：
$$
c=(2,24,1,4,17)
\left[
\begin{matrix}
  10&5 &12 &0& 0 \\
   3&14&21&0&0\\
   8&9&11&0&0\\
   0&0&0&11&8\\
   0&0&0&3&7\\
  \end{matrix}
  \right]
  =
  \left[
\begin{matrix}
  100 \\
   355\\
   539\\
   95\\
   151\\
  \end{matrix}
  \right]^{T}
  (mod26)=
  \left[
\begin{matrix}
  22 \\
   17\\
   19\\
   17\\
   21\\
  \end{matrix}
  \right]^{T}
  <=>
  \left[
  \begin{matrix}
  W\\
  R\\
  T\\
  R\\
  V
  \end{matrix}
  \right]
$$
---------

解密秘钥：
$$
K^{-1}=
\left[
\begin{matrix}
21&15&17&0&0\\
21&2&16&0&0\\
25&4&3&0&0\\
0&0&0&7&18\\
0&0&0&23&11
\end{matrix}
\right]
$$
---------

解密：
$$
p=(22,17,19,17,21)
\left [
\begin{matrix}
21&15&17&0&0\\
21&2&16&0&0\\
25&4&3&0&0\\
0&0&0&7&18\\
0&0&0&23&11
\end{matrix}
\right ]
=
\left [
\begin{matrix}
1328\\
440\\
703\\
602\\
537
\end{matrix}
\right ]^{T}
(mod 26)
=
\left[
\begin{matrix}
2\\
24\\
1\\
4\\
17
\end{matrix}
\right ]
<=>
\left[
\begin{matrix}
c\\y\\
b\\
e\\
r
\end{matrix}
\right]^{T}
$$



-----



# 分组密码

> 分组密码（block cipher）是现代密码学中的重要体制之一，也是应用最广泛、影响最大的一种密码体制。其主要任务是提供数据保密性，也可以用在伪随机数生成器、序列密码、认证码和哈希函数的构造
>
> 分组密码又称为对称密码，具有加解密速度快、安全性好的特点。得到许多密码芯片的支持，在许多研究和应用领域中得到了广泛的应用

## 扩散＆混乱

- 扩散：打乱明文，使得明文和密文之间的统计关系尽量复杂，即从密文不能获得明文的统计特性
- 混乱：打乱明文，使从密文中不能获得密钥的任何统计特性