---
title: linux编程-进程间通信
tags: linux
---

[toc]

# 管道

## 内核提供,单工,自同步机制

## 匿名管道

pipe

> create pipe

```c
#include <unistd.h>
int pipe(int pipefd[2]);
#define _GNU_SOURCE             /* See feature_test_macros(7) */
#include <fcntl.h>              /* Obtain O_* constant definitions */
#include <unistd.h>
int pipe2(int pipefd[2], int flags);
```

## 命名管道

# XSI

IPC -> Internet Process Communication

```sh
ipcs
```

key:ftok

>convert  a pathname and a project identifier to a System V IPC key

```c
#include <sys/types.h>
#include <sys/ipc.h>
key_t ftok(const char *pathname, int proj_id);
```

Message Queues

- msgget

> get a System V message queue identifier

```c
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
int msgget(key_t key, int msgflg);
```

- msgop

> System V message queue operations

```c
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
int msgsnd(int msqid, const void *msgp, size_t msgsz, int msgflg);
ssize_t msgrcv(int msqid, void *msgp, size_t msgsz, long msgtyp,
int msgflg);
```

- msgctl

> System V message control operations

```c
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
int msgctl(int msqid, int cmd, struct msqid_ds *buf);
```

Semaphore Arrays

- semget
- semop
- semctl

Shared Memory

- shmget
- shmop
- shmctl

# 网络套接字socket

## 字节序问题

大端:低地址放高字节

小端:低地址放低字节

## 报式套接字

- socket

> create an endpoint for communication

```c
#include <sys/types.h>          /* See NOTES */
#include <sys/socket.h>
int socket(int domain, int type, int protocol);
```

- bind

> bind a name to a socket

```c
#include <sys/types.h>          /* See NOTES */
#include <sys/socket.h>
int bind(int sockfd, const struct sockaddr *addr,
socklen_t addrlen);
```

- sendto

> send a message on a socket

```c
#include <sys/types.h>
#include <sys/socket.h>
ssize_t send(int sockfd, const void *buf, size_t len, int flags);
ssize_t sendto(int sockfd, const void *buf, size_t len, int flags,
const struct sockaddr *dest_addr, socklen_t addrlen);
ssize_t sendmsg(int sockfd, const struct msghdr *msg, int flags);
```

- rcvfrom



- inet_pton

> convert IPv4 and IPv6 addresses from text to binary form

```c
#include <arpa/inet.h>
int inet_pton(int af, const char *src, void *dst);
```

- inet_ntop

> convert IPv4 and IPv6 addresses from binary to text form

```c
#include <arpa/inet.h>
const char *inet_ntop(int af, const void *src,
char *dst, socklen_t size);
```

- getsockopt

- setsockopt

> get and set options on sockets

```c
#include <sys/types.h>          /* See NOTES */
#include <sys/socket.h>
int getsockopt(int sockfd, int level, int optname,
void *optval, socklen_t *optlen);
int setsockopt(int sockfd, int level, int optname,
const void *optval, socklen_t optlen);
```

### 多点通讯

- 广播
  - 全网广播
  - 子网广播
- 多播/组播

## 流式套接字