<p>[toc]</p>

<blockquote>
  <p>session参数重复校验漏洞</p>
</blockquote>

<h1 id="思路">思路</h1>

<p>由于每次拖动滑块后，会发送一个Request请求数据包到服务器，服务器会验证这个Request请求数据包里携带的位移参数，来判断是否是拖动滑块到了正确的缺口位置。而服务器接收的数据包有很多，除了你发送的，也还会有其他人发送的请求，所以需要一个session参数来作为标识。</p>

<ul>
  <li>
    <p>首先，触发滑动验证机制</p>
  </li>
  <li>
    <p>接着，滑动滑块到正确缺口位置，然后抓包。分析数据包，寻找session参数。</p>

    <blockquote>
      <p>每次滑动正确位移后，使用Brupsuite或者其它中间人代理工具，抓包提取数据包里的session参数，保存到本地</p>
    </blockquote>
  </li>
  <li>
    <p>因为服务器后端默认隐含对我们本地保存的session参数有一个有效时间和有效次数，所以我们不需要再去滑动验证码，直接在session的有效期内发送Request请求数据包到服务器即可验证成功！</p>
  </li>
  <li>
    <p>最后黑产在实际批量注册，薅羊毛或刷赞过程中，遇到触发的滑动验证码机制，只要session在有效期内，只需使用python读取本地的txt内容，调用requests库发送请求数据包，即可绕过滑动验证码</p>
  </li>
</ul>
