<h2 id="docker">Docker</h2>

<ul>
  <li>
    <h4 id="官网"><a href="https://www.docker.com/">官网</a></h4>
  </li>
  <li>
    <h4 id="安装教程"><a href="https://hub.docker.com/search?q=&amp;type=edition&amp;offering=community&amp;operating_system=linux">安装教程</a></h4>
  </li>
  <li>
    <h3 id="基础命令">基础命令</h3>
  </li>
</ul>

<pre><code class="language-bash">Usage:	docker [OPTIONS] COMMAND

A self-sufficient runtime for containers

Options:
      --config string      Location of client config files (default
                           "/home/yourname/.docker")
  -c, --context string     Name of the context to use to connect to the
                           daemon (overrides DOCKER_HOST env var and
                           default context set with "docker context use")
  -D, --debug              Enable debug mode
  -H, --host list          Daemon socket(s) to connect to
  -l, --log-level string   Set the logging level
                           ("debug"|"info"|"warn"|"error"|"fatal")
                           (default "info")
      --tls                Use TLS; implied by --tlsverify
      --tlscacert string   Trust certs signed only by this CA (default
                           "/home/yourname/.docker/ca.pem")
      --tlscert string     Path to TLS certificate file (default
                           "/home/yourname/.docker/cert.pem")
      --tlskey string      Path to TLS key file (default
                           "/home/yourname/.docker/key.pem")
      --tlsverify          Use TLS and verify the remote
  -v, --version            Print version information and quit

Management Commands:
  builder     Manage builds
  config      Manage Docker configs
  container   Manage containers
  context     Manage contexts
  engine      Manage the docker engine
  image       Manage images
  network     Manage networks
  node        Manage Swarm nodes
  plugin      Manage plugins
  secret      Manage Docker secrets
  service     Manage services
  stack       Manage Docker stacks
  swarm       Manage Swarm
  system      Manage Docker
  trust       Manage trust on Docker images
  volume      Manage volumes

Commands:
  attach      Attach local standard input, output, and error streams to a running container
  build       Build an image from a Dockerfile
  commit      Create a new image from a container's changes
  cp          Copy files/folders between a container and the local filesystem
  create      Create a new container
  deploy      Deploy a new stack or update an existing stack
  diff        Inspect changes to files or directories on a container's filesystem
  events      Get real time events from the server
  exec        Run a command in a running container
  export      Export a container's filesystem as a tar archive
  history     Show the history of an image
  images      List images
  import      Import the contents from a tarball to create a filesystem image
  info        Display system-wide information
  inspect     Return low-level information on Docker objects
  kill        Kill one or more running containers
  load        Load an image from a tar archive or STDIN
  login       Log in to a Docker registry
  logout      Log out from a Docker registry
  logs        Fetch the logs of a container
  pause       Pause all processes within one or more containers
  port        List port mappings or a specific mapping for the container
  ps          List containers
  pull        Pull an image or a repository from a registry
  push        Push an image or a repository to a registry
  rename      Rename a container
  restart     Restart one or more containers
  rm          Remove one or more containers
  rmi         Remove one or more images
  run         Run a command in a new container
  save        Save one or more images to a tar archive (streamed to STDOUT by default)
  search      Search the Docker Hub for images
  start       Start one or more stopped containers
  stats       Display a live stream of container(s) resource usage statistics
  stop        Stop one or more running containers
  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
  top         Display the running processes of a container
  unpause     Unpause all processes within one or more containers
  update      Update configuration of one or more containers
  version     Show the Docker version information
  wait        Block until one or more containers stop, then print their exit codes
Run 'docker COMMAND --help' for more information on a command.
</code></pre>

<ul>
  <li>
    <h4 id="docker--for-ubuntu-images">Docker  For Ubuntu Images</h4>
  </li>
</ul>

<h4 id="网站"><a href="https://hub.docker.com/_/ubuntu?tab=tags&amp;page=1">网站</a></h4>

<ul>
  <li>
    <h3 id="拉取最新版的-ubuntu-镜像">拉取最新版的 Ubuntu 镜像</h3>
  </li>
</ul>

<pre><code class="language-bash">docker pull ubuntu:latest
</code></pre>

<ul>
  <li>
    <h4 id="查看本地镜像">查看本地镜像</h4>
  </li>
</ul>

<pre><code class="language-bash">docker images
</code></pre>

<ul>
  <li>
    <h4 id="删除镜像">删除镜像</h4>
  </li>
</ul>

<p><code>docker rmi </code></p>

<ul>
  <li>
    <h4 id="构建镜像">构建镜像</h4>
  </li>
</ul>

<p><code>docker build </code></p>

<p>需要创建一个 <code>Dockerfile</code> 文件，其中包含一组指令来告诉 Docker 如何构建我们的镜像</p>

<pre><code class="language-dockerfile">FROM    centos:6.7
MAINTAINER      Fisher "fisher@sudops.com"

RUN     /bin/echo 'root:123456' |chpasswd
RUN     useradd runoob
RUN     /bin/echo 'runoob:123456' |chpasswd
RUN     /bin/echo -e "LANG=\"en_US.UTF-8\"" &gt;/etc/default/local
EXPOSE  22
EXPOSE  80
CMD     /usr/sbin/sshd -D
</code></pre>

<p>每一个指令都会在镜像上创建一个新的层，每一个指令的前缀都必须是大写的。</p>

<p>第一条FROM，指定使用哪个镜像源</p>

<p>RUN 指令告诉docker 在镜像内执行命令，安装了什么。。。</p>

<p>然后，我们使用<code>Dockerfile</code> 文件，通过 <code>docker build</code> 命令来构建一个镜像</p>

<pre><code class="language-bash"> docker build -t runoob/centos:6.7 .
</code></pre>

<pre><code>Sending build context to Docker daemon 17.92 kB
Step 1 : FROM centos:6.7
 ---&amp;gt; d95b5ca17cc3
Step 2 : MAINTAINER Fisher "fisher@sudops.com"
 ---&amp;gt; Using cache
 ---&amp;gt; 0c92299c6f03
Step 3 : RUN /bin/echo 'root:123456' |chpasswd
 ---&amp;gt; Using cache
 ---&amp;gt; 0397ce2fbd0a
Step 4 : RUN useradd runoob
......
</code></pre>

<ol>
  <li><strong>-t</strong> ：指定要创建的目标镜像名</li>
  <li><strong>.</strong> ：Dockerfile 文件所在目录，可以指定Dockerfile 的绝对路径</li>
</ol>

<ul>
  <li>
    <h4 id="查看端口的绑定情况">查看端口的绑定情况</h4>
  </li>
</ul>

<p><code>docker port </code></p>

<ul>
  <li>
    <h4 id="运行容器">运行容器</h4>
  </li>
</ul>

<pre><code class="language-bash">docker run -itd --name ubuntu-test ubuntu
</code></pre>

<h4 id="exec-命令进入-ubuntu-容器">exec 命令进入 ubuntu 容器</h4>

<pre><code class="language-bash">docker exec -it ubuntu-test /bin/bas
</code></pre>

<hr />

<ul>
  <li>
    <h4 id="运行交互式的容器">运行交互式的容器</h4>
  </li>
</ul>

<pre><code class="language-bash">docker run -i -t docker_image /bin/bash
</code></pre>

<ol>
  <li><code>-t</code>在新容器内指定一个伪终端或终端</li>
  <li><code>-i</code>允许你对容器内的标准输入 (<code>STDIN</code>) 进行交互</li>
</ol>

<ul>
  <li>
    <h4 id="docker-ps">docker ps</h4>
  </li>
</ul>

<ol>
  <li><strong>CONTAINER ID</strong>:容器 ID</li>
  <li><strong>IMAGE:</strong> 使用的镜像</li>
  <li><strong>COMMAND:</strong> 启动容器时运行的命令</li>
  <li><strong>CREATED:</strong> 容器的创建时间</li>
  <li><strong>STATUS:</strong> 容器状态
    <ol>
      <li>created（已创建）</li>
      <li>restarting（重启中）</li>
      <li>running（运行中）</li>
      <li>removing（迁移中）</li>
      <li>paused（暂停）</li>
      <li>exited（停止）</li>
      <li>dead（死亡）</li>
    </ol>
  </li>
  <li><strong>PORTS:</strong> 容器的端口信息和使用的连接类型（tcp\udp）</li>
  <li><strong>NAMES:</strong> 自动分配的容器名称</li>
</ol>

<ul>
  <li>
    <h4 id="停止容器">停止容器</h4>
  </li>
</ul>

<pre><code class="language-bash">docker stop CONTAINER ID
</code></pre>

<ul>
  <li>
    <h4 id="重启容器">重启容器</h4>
  </li>
</ul>

<pre><code class="language-bash"> docker restart CONTAINER ID
</code></pre>

<ul>
  <li>
    <h4 id="进入容器">进入容器</h4>
  </li>
</ul>

<p>在使用 <strong>-d</strong> 参数时，容器启动后会进入后台。此时想要进入容器，可以通过以下指令进入：</p>

<pre><code class="language-bash">docker attach  CONTAINER ID
</code></pre>

<pre><code class="language-bash">docker exec -it CONTAINER ID /bin/bash
</code></pre>

<p>推荐使用 <code>docker exec</code> 命令，因为此退出容器终端，不会导致容器的停止。</p>

<p>更多参数说明请使用 <code>docker exec --help</code> 命令查看</p>

<ul>
  <li>
    <h4 id="导出容器"><strong>导出容器</strong></h4>
  </li>
</ul>

<pre><code class="language-bash">docker export  CONTAINER ID &gt; dockername.tar
</code></pre>

<ul>
  <li>
    <h4 id="导入容器快照"><strong>导入容器快照</strong></h4>
  </li>
</ul>

<pre><code class="language-bash">cat docker/ubuntu.tar | docker import - test/ubuntu:v1
也可以通过指定 URL 或者某个目录来导入
docker import http://example.com/exampleimage.tgz example/imagerepo
</code></pre>

<ul>
  <li>
    <h3 id="删除容器">删除容器</h3>
  </li>
</ul>

<pre><code class="language-bash">docker rm -f CONTAINER ID
</code></pre>

<ul>
  <li>
    <h4 id="运行一个-web-应用flask">运行一个 web 应用(Flask)</h4>
  </li>
</ul>

<pre><code class="language-bash">docker pull training/webapp  # 载入镜像
docker run -d -P training/webapp python app.py
</code></pre>

<p><strong>-d:</strong>让容器在后台运行。</p>

<p><strong>-P:</strong>将容器内部使用的网络端口映射到我们使用的主机上</p>

<ul>
  <li>
    <h4 id="查看-web-应用程序日志">查看 WEB 应用程序日志</h4>
  </li>
</ul>

<pre><code class="language-bash">docker logs -f  CONTAINER ID
</code></pre>

<p><strong>-f:</strong> 让 <strong>docker logs</strong> 像使用 <strong>tail -f</strong> 一样来输出容器内部的标准输出</p>

<ul>
  <li>
    <h4 id="查看web应用程序容器的进程">查看WEB应用程序容器的进程</h4>
  </li>
</ul>

<p><code> docker top</code> 来查看容器内部运行的进程</p>

<p><code>docker inspect </code>查看 Docker 的底层信息</p>

<ul>
  <li>
    <h4 id="停止-web-应用容器">停止 WEB 应用容器</h4>
  </li>
</ul>

<p><code>docker stop </code></p>

<ul>
  <li>
    <h4 id="重启web应用容器">重启WEB应用容器</h4>
  </li>
</ul>

<p><code>docker start</code></p>

<ul>
  <li>
    <h4 id="移除web应用容器">移除WEB应用容器</h4>
  </li>
</ul>

<p><code> docker rm</code></p>
